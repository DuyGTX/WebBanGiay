@using WebBanGiay.Models.Dto;
@using System.Drawing.Drawing2D;
@model ProductDto
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
	Layout = "~/Views/Shared/header-footer-admin.cshtml";
	<script defer src="~/assets/plugins/fontawesome/js/all.min.js"></script>

	<!-- App CSS -->
	<link id="theme-style" rel="stylesheet" href="~/assets/css/portal.css">
	<link id="style" rel="stylesheet" href="~/css/site.css">

	<!-- Javascript -->
	<script src="~/assets/plugins/popper.min.js"></script>
	<script src="~/assets/plugins/bootstrap/js/bootstrap.min.js"></script>

	<!-- Page Specific JS -->
	<script src="~/assets/js/app.js"></script>

}
<body class="app">
	<div class="app-wrapper">
		<div class="app-content pt-3 p-md-3 p-lg-4">
			<div class="container-xl">
				<h1 class="app-page-title">@Model.ShoeName</h1>
				<hr class="mb-4">
				<div class="row g-4 settings-section">


					<div class="app-card app-card-settings shadow-sm p-4">

						<div class="app-card-body">
							<form class="settings-form" method="post" enctype="multipart/form-data">

								<div class="row mb-3">
									<label for="setting-input-1" class="form-label">
										ID<span class="ms-2" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-placement="top" data-bs-content="Không vượt quá 100 ký tự.">
											<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-info-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
												<path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
												<path d="M8.93 6.588l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588z" />
												<circle cx="8" cy="4.5" r="1" />
											</svg>
										</span>
									</label>


									<input value="@Model.ShoeId" class="form-control" readonly />

									<!-- Input hidden để truyền giá trị -->
									<input asp-for="ShoeId" type="hidden" />
								</div>
								<div class="row mb-3">
									<label for="setting-input-1" class="form-label">
										Shoe Name<span class="ms-2" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-placement="top" data-bs-content="Không vượt quá 100 ký tự.">
											<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-info-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
												<path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
												<path d="M8.93 6.588l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588z" />
												<circle cx="8" cy="4.5" r="1" />
											</svg>
										</span>
									</label>
									<!-- Input readonly để hiển thị -->
									<input value="@Model.ShoeName" class="form-control" readonly />

									<!-- Input hidden để truyền giá trị -->
									<input asp-for="@Model.ShoeName" type="hidden" />
								</div>
								<div class="row mb-3">
									<label for="setting-input-1" class="form-label">
										Category Name
										<span class="ms-2" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-placement="top" data-bs-content="Không vượt quá 100 ký tự.">
											<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-info-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
												<path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
												<path d="M8.93 6.588l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588z" />
												<circle cx="8" cy="4.5" r="1" />
											</svg>
										</span>
									</label>
									<input value="@ViewBag.CategoryName" class="form-control" readonly />
									<!-- Input hidden để truyền giá trị -->
									<input asp-for="@Model.CategoryId" type="hidden" />
								</div>

								<div class="row mb-3">
									<label for="setting-input-1" class="form-label">
										Brand Name<span class="ms-2" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-placement="top" data-bs-content="Không vượt quá 100 ký tự.">
											<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-info-circle" fill="currentColor" xmlns="http:www.w3.org/2000/svg">
												<path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
												<path d="M8.93 6.588l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588z" />
												<circle cx="8" cy="4.5" r="1" />
											</svg>
										</span>
									</label>
									<input value="@ViewBag.BrandName" class="form-control" readonly />
									<!-- Input hidden để truyền giá trị -->
									<input asp-for="@Model.BrandId" type="hidden" />
								</div>
								<div class="row mb-3">
									<label for="price" class="form-label">Price</label>
									<div class="input-group mb-2">
										<input type="text" class="form-control" value="@(Model.Price?.ToString("N0")) VNĐ" readonly />
										<input type="hidden" name="ShoeItems[].Price" value="@Model.Price" />
										<div class="input-group-text">
											<i class="bi bi-currency-dollar"></i>
										</div>
									</div>
								</div>
								<div class="row mb-3">
									<label for="price" class="form-label">Sale Price</label>
									<div class="input-group mb-2">
										<input type="text" class="form-control" value="@(Model.SalePrice?.ToString("N0")) VNĐ" readonly />
										<input type="hidden" name="ShoeItems[].SalePrice" value="@Model.SalePrice" />
										<div class="input-group-text">
											<i class="bi bi-currency-dollar"></i>
										</div>
									</div>
								</div>

								<div class="row mb-3">
									<div class="col-12">
										<label class="form-label">Size</label>
										<div class="size-grid">
											@if (Model.Sizes != null && Model.Sizes.Any())
											{
												var uniqueSizes = Model.Sizes
												.DistinctBy(s => s.SizeId)  // Lọc các kích thước duy nhất theo SizeId
												.OrderBy(s => s.SizeName)   // Sắp xếp theo SizeName
												.ToList();

												@foreach (var size in uniqueSizes)
												{
													<div class="size-box" onclick="selectSize(@size.SizeId, '@size.SizeName')">
														@size.SizeName
													</div>
												}
											}
										</div>


									</div>

									<div class="col-12 mt-3">
										<label class="form-label">Colour</label>
										<div class="color-grid">
											@if (Model.Colours != null && Model.Colours.Any())
											{
												var uniqueColours = Model.Colours
												.DistinctBy(s => s.ColourId)  // Lọc các kích thước duy nhất theo SizeId
												.OrderBy(s => s.ColourName)   // Sắp xếp theo SizeName
												.ToList();

												@foreach (var colour in uniqueColours)
												{
													<div class="size-box" onclick="selectSize(@colour.ColourId, '@colour.ColourName')">
														@colour.ColourName
													</div>
												}
											}
										</div>
									</div>
								</div>

								
								
									<div class="row mb-3">
										<label for="setting-input-1" class="form-label">
											Images
											<span class="ms-2" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-placement="top" data-bs-content="Không vượt quá 100 ký tự.">
												<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-info-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
													<path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
													<path d="M8.93 6.588l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588z" />
													<circle cx="8" cy="4.5" r="1" />
												</svg>
											</span>
										</label>

									@if (Model.ShoeImages != null && Model.ShoeImages.Any())
									{
										<div class="image-gallery">
											<div class="main-image mb-3">
												<img id="selectedImage" src="@Model.ShoeImages.First().ImageUrl" alt="Main Image" class="img-fluid rounded" />
											</div>
											<div class="image-thumbnails d-flex flex-wrap gap-2">
												@foreach (var image in Model.ShoeImages)
												{
													<div class="thumbnail-wrapper">
														<img src="@image.ImageUrl"
															 alt="Product Image"
															 class="thumb-image"
															 onclick="selectImage(this.src)"
															 data-image-id="@image.ImageId" />
													</div>
												}
											</div>
										</div>
									}
									else
									{
										<p class="text-muted">Không có hình ảnh</p>
									}
									</div>
									


								<div class="row mb-3">
									<label for="setting-input-1" class="form-label">
										SKU
										<span class="ms-2" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-placement="top" data-bs-content="Không vượt quá 100 ký tự.">
											<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-info-circle" fill="currentColor" xmlns="http:www.w3.org/2000/svg">
												<path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
												<path d="M8.93 6.588l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588z" />
												<circle cx="8" cy="4.5" r="1" />
											</svg>
										</span>
									</label>
									<input value="@Model.Sku" class="form-control" readonly />

									<!-- Input hidden để truyền giá trị -->
									<input asp-for="@Model.Sku" type="hidden" />

									<div class="row mb-3">
										<label for="setting-input-1" class="form-label">
											Description<span class="ms-2" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-placement="top" data-bs-content="Không vượt quá 100 ký tự.">
												<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-info-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
													<path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
													<path d="M8.93 6.588l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588z" />
													<circle cx="8" cy="4.5" r="1" />
												</svg>
											</span>
										</label>
										<!-- Input readonly để hiển thị -->
										<input value="@Model.ShoeDescription" class="form-control" readonly />

										<!-- Input hidden để truyền giá trị -->
										<input asp-for="@Model.ShoeDescription" type="hidden" />
									</div>
									<div class="row mb-3">
										<label for="setting-input-1" class="form-label">
											Care Instructions<span class="ms-2" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-placement="top" data-bs-content="Không vượt quá 100 ký tự.">
												<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-info-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
													<path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
													<path d="M8.93 6.588l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588z" />
													<circle cx="8" cy="4.5" r="1" />
												</svg>
											</span>
										</label>
										<!-- Input readonly để hiển thị -->
										<input value="@Model.CareInstructions" class="form-control" readonly />

										<!-- Input hidden để truyền giá trị -->
										<input asp-for="@Model.CareInstructions" type="hidden" />
									</div>
								</div>


								
								<div class="row justify-content-center">
									
									<div class="col-sm-2 d-grid">
										<a asp-area="Admins" asp-controller="Product" asp-action="Index"
										   class="btn btn-sm app-btn-primary"
										   role="button">
											Thoát
										</a>
									</div>
								</div>
								
							</form>
						</div><!--//app-card-body-->

					</div><!--//app-card-->
			
				</div><!--//row-->
			
			</div><!--//container-fluid-->
		</div><!--//app-content-->
	</div><!--//app-content-->
</body>




@section Scripts {
	
	<!-- Script để tự động ẩn thông báo sau 5 giây -->
<!-- CSS để thêm animation -->
<!-- Script để tự động ẩn thông báo sau 5 giây -->
<script>
	setTimeout(function () {
		var alerts = document.querySelectorAll('.alert');
		alerts.forEach(function (alert) {
			var bsAlert = new bootstrap.Alert(alert);
			bsAlert.close();
		});
	}, 5000);
</script>
<style>
	.image-gallery {
		max-width: 800px;
	}

	.main-image {
		width: 100%;
		height: 400px;
		overflow: hidden;
		border-radius: 8px;
		box-shadow: 0 2px 4px rgba(0,0,0,0.1);
	}

		.main-image img {
			width: 100%;
			height: 100%;
			object-fit: contain;
		}

	.thumbnail-wrapper {
		width: 100px;
		height: 100px;
		overflow: hidden;
		border-radius: 4px;
		cursor: pointer;
		transition: transform 0.2s;
	}

		.thumbnail-wrapper:hover {
			transform: scale(1.05);
		}

	.thumb-image {
		width: 100%;
		height: 100%;
		object-fit: cover;
		border: 2px solid transparent;
	}

		.thumb-image.selected {
			border-color: #007bff;
		}

	.image-thumbnails {
		overflow-x: auto;
		padding: 10px 0;
	}
</style>

<script>
	function selectImage(src) {
		// Cập nhật hình ảnh chính
		document.getElementById('selectedImage').src = src;

		// Cập nhật trạng thái selected cho thumbnails
		document.querySelectorAll('.thumb-image').forEach(img => {
			img.classList.remove('selected');
			if (img.src === src) {
				img.classList.add('selected');
			}
		});
	}

	// Khởi tạo Popover của Bootstrap
	var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
	var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
		return new bootstrap.Popover(popoverTriggerEl);
	});

	// Chọn hình ảnh đầu tiên khi trang load
	document.addEventListener('DOMContentLoaded', function () {
		const firstThumb = document.querySelector('.thumb-image');
		if (firstThumb) {
			firstThumb.classList.add('selected');
		}
	});
</script>

	<style>
		.size-grid, .color-grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
			gap: 10px;
			margin-top: 10px;
		}

		.size-box, .color-box {
			border: 1px solid #dee2e6;
			padding: 10px;
			text-align: center;
			cursor: pointer;
			border-radius: 5px;
			transition: all 0.3s;
		}

			.size-box:hover, .color-box:hover {
				border-color: #0d6efd;
				background-color: #f8f9fa;
			}

		.selected {
			background-color: #0d6efd !important;
			color: white;
			border-color: #0d6efd;
		}
	</style>
}
